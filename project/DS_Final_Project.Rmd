---
title: "Intro to DS Final Project"
output: html_notebook
---

# Is my music taste bad?
### An exploratory data analysis and comparison of the top 100 songs trending currently to my top songs from 2017-2021 by year

## Introduction
Music is one of the greatest forms of self-expression. You can learn a lot about a person based on their favorite songs and artists. 

This made me wonder, what does my music taste say about me -- and is it objectively good or bad (in comparison to popular music, of course). Personally, I change up what I listen to based on the year.

The data for this analysis was collected using the Spotify API for the "Top Songs - USA" playlist as well as my personal Spotify Wrapped playlists from 2017, 2018, 2019, and 2020. To incorporate my current music taste as of 2021, I complied 100 songs that I have been listening to so far this year. 

This exploratory analysis will cover most of the audio features supplied by the Spotify API, including:

- Danceabiity: "how suitable a track is for dancing based on a combination of musical elements including tempo, rhythm stability, beat strength, and overall regularity," on a scale from 0 to 1
- Energy: "a perceptual measure of intensity and activity," on a scale from 0 to 1
- Speechiness: "speechiness detects the presence of spoken words in a track," on a scale from 0 to 1, 1 being entirely spoken
- Acousticness: "whether the track is acoustic," on a scale from 0 to 1, 1 being acoustic
- Instrumentalness: "predicts whether a track contains no vocals," on a scale from 0 to 1, 1 being instrumental
- Liveness: "detects the presence of an audience in the recording," on a scale from 0 to 1, 1 being definitely a live performance
- Valence: "describes the musical positiveness conveyed by a track," on a scale from 0 to 1


## Theory
The goal of this exploratory analysis is to see how my personal music compares to what is popular using the Spotify API data. I believe that my music taste is... interesting. It definitely is all over the place so I am intrigued as to how it compares.

### Classification of the "vibe" for each year
|Year|Genre|Vibes|Top Artist|
|:---:|:---:|:----:|:--:|
|2017|Alt-Rock|Emo|Bring Me The Horizon|
|2018|Happy-Pop|Happy|AJR|
|2019|Emo-Rap|Questionable|Juice Wrld|
|2020|Electro-Pop|High-Energy|Quinn XCII|
|2021|Chill-Pop|Vibey|Dominic Fike|

I will be looking at each factor listed above, finding mean values for each, and then comparing to my music by year. Does emo Ahna have the best taste? Pop Ahna? Rap Ahna? Let's find out.

## Prerequisites

Load the required packages:
```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
```

## Dataset

Load the required raw data sets:
```{r}
my_2021 <- readRDS("ahna_2021.RDS") 
my_2020 <- readRDS("ahna_2020.RDS") 
my_2019 <- readRDS("ahna_2019.RDS") 
my_2018 <- readRDS("ahna_2018.RDS") 
my_2017 <- readRDS("ahna_2017.RDS") 
trending <- readRDS("ahna_trending.RDS") 
```

## Data Filtering

Here, I am selecting the factors I want to examine and dropping any NA values.

```{r}
new_2021 <- my_2021 %>%
  select(danceability, energy, speechiness, acousticness, liveness, valence, track.popularity, track.name) %>%
  drop_na()

new_2020 <- my_2020 %>%
  select(danceability, energy, speechiness, acousticness, liveness, valence, track.popularity, track.name) %>%
  drop_na()

new_2019 <- my_2019 %>%
  select(danceability, energy, speechiness, acousticness, liveness, valence, track.popularity, track.name) %>%
  drop_na()

new_2018 <- my_2018 %>%
  select(danceability, energy, speechiness, acousticness, liveness, valence, track.popularity, track.name) %>%
  drop_na()

new_2017 <- my_2017 %>%
  select(danceability, energy, speechiness, acousticness, liveness, valence, track.popularity, track.name) %>%
  drop_na()

new_trending <- trending %>%
  select(danceability, energy, speechiness, acousticness, liveness, valence, track.popularity, track.name) %>%
  drop_na()
```

## Rating Classif-ication

What is a good danceability of a popular song? What about energy? Loudness? To find our rating classification, I will take the quartiles (Q1, Q2(mean), Q3) for each factor and compare them to my own by year. 

```{r}
q_trending <- data.frame(
  q_danceability = quantile(new_trending[["danceability"]], probs = seq(0, 1, 0.25), na.rm = T),
  q_energy = quantile(new_trending[["energy"]], probs = seq(0, 1, 0.25), na.rm = T),
  q_speechiness = quantile(new_trending[["speechiness"]], probs = seq(0, 1, 0.25), na.rm = T),
  q_acousticness = quantile(new_trending[["acousticness"]], probs = seq(0, 1, 0.25), na.rm = T),
  q_liveness = quantile(new_trending[["liveness"]], probs = seq(0, 1, 0.25), na.rm = T),
  q_valence = quantile(new_trending[["valence"]], probs = seq(0, 1, 0.25), na.rm = T)
)
q_trending
```

## Scoring 

The goal is to analyze each factor for each year and compare it to the quartile values of the trending songs. Because every song on this particular playlist is trending, the peak value for scoring is around the mean, and decreases as it furthers from the mean value. This is taken into account to make the following scoring guidelines:

||0<=X<Q0|Q0<=X<Q1|Q1<=X<Q2|Q2<=X<Q3|Q3<=X<Q4|Q4<=X<=1|
|:----:|:-:|:-:|:-:|:-:|:--:|:--:|
|Score|0|1|2|2|1|0|

```{r}
scoring_danceability <- function(danceability) {
  if(danceability >= 0 && danceability < 0.331) {
    return(0)
  }
  else if(danceability >= 0.331 && danceability < 0.5845) {
    return(1)
  }
  else if(danceability >= 0.5845 && danceability < 0.7010) {
    return(2)
  }
  else if(danceability >= 0.7010 && danceability < 0.7810) {
    return(2)
  }
  else if(danceability >= 0.7810 && danceability < 0.9650) {
    return(1)
  }
  else if(danceability >= 0.9650 && danceability < 1) {
    return(0)
  }
}
```

```{r}
scoring_energy <- function(energy) {
  if(energy >= 0 && energy < 0.2250) {
    return(0)
  }
  else if(energy >= 0.2250 && energy < 0.5365) {
    return(1)
  }
  else if(energy >= 0.5365 && energy < 0.6175) {
    return(2)
  }
  else if(energy >= 0.6175 && energy < 0.7230) {
    return(2)
  }
  else if(energy > 0.7230 && energy <= 0.9340) {
    return(1)
  }
  else if(energy > 0.9340 && danceability <= 1) {
    return(0)
  }
}
```

```{r}
scoring_speechiness <- function(speechiness) {
  if(speechiness >= 0 && speechiness < 0.02360) {
    return(0)
  }
  else if(speechiness >= 0.02360 && speechiness < 0.03850) {
    return(1)
  }
  else if(speechiness >= 0.03850 && speechiness < 0.06885) {
    return(2)
  }
  else if(speechiness >= 0.06885 && speechiness < 0.17425) {
    return(2)
  }
  else if(speechiness > 0.17425 && speechiness <= 0.55900) {
    return(1)
  }
  else if(speechiness > 0.55900 && speechiness <= 1) {
    return(0)
  }
}
```

```{r}
scoring_acousticness <- function(acousticness) {
  if(acousticness >= 0 && acousticness < 0.000602) {
    return(0)
  }
  else if(acousticness >= 0.000602 && acousticness < 0.021425) {
    return(1)
  }
  else if(acousticness >= 0.021425 && acousticness < 0.133000) {
    return(2)
  }
  else if(acousticness >= 0.133000 && acousticness < 0.285500) {
    return(2)
  }
  else if(acousticness > 0.285500 && acousticness <= 0.833000) {
    return(1)
  }
  else if(acousticness > 0.833000 && acousticness <= 1) {
    return(0)
  }
}
```

```{r}
scoring_liveness <- function(liveness) {
  if(liveness >= 0 && liveness < 0.046100) {
    return(0)
  }
  else if(liveness >= 0.046100 && liveness < 0.096975) {
    return(1)
  }
  else if(liveness >= 0.096975 && liveness < 0.120000) {
    return(2)
  }
  else if(liveness >= 0.120000 && liveness < 0.185500) {
    return(2)
  }
  else if(liveness > 0.185500 && liveness <= 0.688000) {
    return(1)
  }
  else if(liveness > 0.688000 && liveness <= 1) {
    return(0)
  }
}
```

```{r}
scoring_valence <- function(valence) {
  if(valence >= 0 && valence < 0.06280) {
    return(0)
  }
  else if(valence >= 0.06280 && valence < 0.34075) {
    return(1)
  }
  else if(valence >= 0.34075 && valence < 0.48100) {
    return(2)
  }
  else if(valence >= 0.48100 && valence < 0.64175) {
    return(2)
  }
  else if(valence > 0.64175 && valence <= 0.93400) {
    return(1)
  }
  else if(valence > 0.93400 && valence <= 1) {
    return(0)
  }
}
```

Because the scoring is calculated based off of the mean values of the trending songs, the trending playlist has a perfect score of 12, as seen here:

```{r}
scoring_total_trending <- function(a, b, c, d, e, f){
 a = scoring_danceability(mean(new_trending[["danceability"]]))
 b = scoring_energy(mean(new_trending[["energy"]]))
 c = scoring_speechiness(mean(new_trending[["speechiness"]]))
 d = scoring_acousticness(mean(new_trending[["acousticness"]]))
 e = scoring_liveness(mean(new_trending[["liveness"]]))
 f = scoring_valence(mean(new_trending[["valence"]]))
 return(sum(a,b,c,d,e,f))
}
scoring_total_trending(a, b, c, d, e, f)

```

## Analysis

### The year of sad: 2017

```{r}
 a_2017 <- scoring_danceability(mean(new_2017[["danceability"]]))
 b_2017 <- scoring_energy(mean(new_2017[["energy"]]))
 c_2017 <- scoring_speechiness(mean(new_2017[["speechiness"]]))
 d_2017 <- scoring_acousticness(mean(new_2017[["acousticness"]]))
 e_2017 <- scoring_liveness(mean(new_2017[["liveness"]]))
 f_2017 <- scoring_valence(mean(new_2017[["valence"]]))
```

```{r}
scoring_2017 <- c(a_2017, b_2017, c_2017, d_2017, e_2017, f_2017)
```


Putting the 2017 playlist through the scoring algorithm produces the value of 10, as seen here:

```{r}
scoring_total_2017 <- function(a, b, c, d, e, f){
 return(sum(a,b,c,d,e,f))
}
scoring_total_2017(a_2017, b_2017, c_2017, d_2017, e_2017, f_2017)
```


### The year of happy: 2018

```{r}
 a_2018 <- scoring_danceability(mean(new_2018[["danceability"]]))
 b_2018 <- scoring_energy(mean(new_2018[["energy"]]))
 c_2018 <- scoring_speechiness(mean(new_2018[["speechiness"]]))
 d_2018 <- scoring_acousticness(mean(new_2018[["acousticness"]]))
 e_2018 <- scoring_liveness(mean(new_2018[["liveness"]]))
 f_2018 <- scoring_valence(mean(new_2018[["valence"]]))
```

```{r}
scoring_2018 <- c(a_2018, b_2018, c_2018, d_2018, e_2018, f_2018)
```


Putting the 2018 playlist through the scoring algorithm produces a perfect score of 12, as seen here:

```{r}
scoring_total_2018 <- function(a, b, c, d, e, f){
 return(sum(a,b,c,d,e,f))
}
scoring_total_2017(a_2018, b_2018, c_2018, d_2018, e_2018, f_2018)
```

### The year of questionable decisions: 2019


```{r}
 a_2019 <- scoring_danceability(mean(new_2019[["danceability"]]))
 b_2019 <- scoring_energy(mean(new_2019[["energy"]]))
 c_2019 <- scoring_speechiness(mean(new_2019[["speechiness"]]))
 d_2019 <- scoring_acousticness(mean(new_2019[["acousticness"]]))
 e_2019 <- scoring_liveness(mean(new_2019[["liveness"]]))
 f_2019 <- scoring_valence(mean(new_2019[["valence"]]))
```


```{r}
scoring_2019 <- c(a_2019, b_2019, c_2019, d_2019, e_2019, f_2019)
```


Putting the 2019 playlist through the scoring algorithm produces a score of 10, as seen here:

```{r}
scoring_total_2019 <- function(a, b, c, d, e, f){
 return(sum(a,b,c,d,e,f))
}
scoring_total_2019(a_2019, b_2019, c_2019, d_2019, e_2019, f_2019)
```


### The year of chaotic energy: 2020

```{r}
 a_2020 <- scoring_danceability(mean(new_2020[["danceability"]]))
 b_2020 <- scoring_energy(mean(new_2020[["energy"]]))
 c_2020 <- scoring_speechiness(mean(new_2020[["speechiness"]]))
 d_2020 <- scoring_acousticness(mean(new_2020[["acousticness"]]))
 e_2020 <- scoring_liveness(mean(new_2020[["liveness"]]))
 f_2020 <- scoring_valence(mean(new_2020[["valence"]]))
```


```{r}
scoring_2020 <- c(a_2020, b_2020, c_2020, d_2020, e_2020, f_2020)
```


Putting the 2020 playlist through the scoring algorithm produces a score of 10, as seen here:

```{r}
scoring_total_2020 <- function(a, b, c, d, e, f){
 return(sum(a,b,c,d,e,f))
}
scoring_total_2020(a_2020, b_2020, c_2020, d_2020, e_2020, f_2020)
```


### The year of immaculate vibes: 2021

```{r}
 a_2021 <- scoring_danceability(mean(new_2021[["danceability"]]))
 b_2021 <- scoring_energy(mean(new_2021[["energy"]]))
 c_2021 <- scoring_speechiness(mean(new_2021[["speechiness"]]))
 d_2021 <- scoring_acousticness(mean(new_2021[["acousticness"]]))
 e_2021 <- scoring_liveness(mean(new_2021[["liveness"]]))
 f_2021 <- scoring_valence(mean(new_2021[["valence"]]))
```


```{r}
scoring_2021 <- c(a_2021, b_2021, c_2021, d_2021, e_2021, f_2021)
```


Putting the 2020 playlist through the scoring algorithm produces a score of 11, as seen here:

```{r}
scoring_total_2021 <- function(a, b, c, d, e, f){
 return(sum(a,b,c,d,e,f))
}
scoring_total_2021(a_2021, b_2021, c_2021, d_2021, e_2021, f_2021)
```

## Conclusion

```{r}
scores <- data.frame(
  factor = c("Danceability", "Energy", "Speechiness", "Acousticness", "Liveness", "Valence"),
  scoring_2017, scoring_2018, scoring_2019, scoring_2020, scoring_2021
)
scores
```

```{r}
scores %>%
  pivot_longer(cols = c(scoring_2017, scoring_2018, scoring_2019, scoring_2020, scoring_2021), names_to = "year") %>%
  ggplot() +
  geom_col(aes(x = factor, y = value, color = year),
           position = "dodge")
```

